Build a 2D Navierâ€“Stokes Fluid Simulation Engine From Scratch in Python
You are an expert computational physicist and numerical analyst.
Design and implement a 2D incompressible Navierâ€“Stokes solver from scratch in Python, without using CFD libraries. Only NumPy, SciPy, and Matplotlib are allowed.
The program must be mathematically rigorous, modular, efficient, and well-documented.
ğŸ”¬ Mathematical Model
Solve the 2D incompressible Navierâ€“Stokes equations:
Continuity equation:
âˆ‡ Â· u = 0
Momentum equation:
âˆ‚u/âˆ‚t + (u Â· âˆ‡)u = âˆ’(1/Ï)âˆ‡p + Î½âˆ‡Â²u + f
Where:
u = velocity field (u, v)
p = pressure
Ï = density
Î½ = kinematic viscosity
f = external force field
ğŸ§  Numerical Requirements
Implement:
1ï¸âƒ£ Discretization
Use Finite Difference Method
Use staggered grid (MAC grid preferred)
Central difference for spatial derivatives
Explicit time stepping (Euler or RK2)
CFL stability condition check
2ï¸âƒ£ Pressureâ€“Velocity Coupling
Implement Projection Method:
Step 1: Compute intermediate velocity (ignoring pressure)
Step 2: Solve Pressure Poisson Equation:
âˆ‡Â²p = (Ï/Î”t) âˆ‡ Â· u*
Step 3: Correct velocity:
uâ¿âºÂ¹ = u* âˆ’ (Î”t/Ï) âˆ‡p
Implement Poisson solver using:
Gaussâ€“Seidel iteration
OR
Conjugate Gradient method
3ï¸âƒ£ Boundary Conditions
Support:
No-slip walls
Periodic boundary
Lid-driven cavity case
4ï¸âƒ£ Stability & Verification
Implement CFL condition monitor
Show divergence magnitude over time
Validate against known analytical solution (e.g., Taylorâ€“Green vortex)
5ï¸âƒ£ Visualization
Velocity vector field
Streamlines
Vorticity field
Real-time animation
Use matplotlib animation module.
6ï¸âƒ£ Code Structure
Organize project as:
/fluid_solver
    main.py
    grid.py
    solver.py
    pressure.py
    visualization.py
    utils.py
Use:
Object-oriented design
Type hints
Docstrings with equations
Clear separation of math and visualization
ğŸ“Š Performance Considerations
Use NumPy vectorization (avoid Python loops)
Preallocate arrays
Profile performance
Optionally implement Numba acceleration
ğŸ§ª Test Case
Implement lid-driven cavity flow:
Square domain
Top wall moving with constant velocity
Reynolds number adjustable
Plot:
Centerline velocity profile
Compare with benchmark data
ğŸ“ˆ Bonus Advanced Extensions
If base solver works:
Implement 3D extension
Implement turbulence model (kâ€“Îµ)
Add adaptive time stepping
GPU acceleration with CuPy
Parallel Poisson solver
ğŸ“˜ Output Requirements
Program must:
Run from command line
Allow parameter configuration
Save simulation data
Generate animated visualization
Print stability diagnostics
ğŸ¯ Goal
Create a mathematically correct, research-level CFD solver suitable for:
Engineering simulation
Educational demonstration
Scientific experimentation
